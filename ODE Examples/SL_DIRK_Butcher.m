function [A,b,c] = SL_DIRK_Butcher(s,p,q,scheme_no)
%=========================================================================%
% This code provides different RK methods depending on (s, p, q). 
% For a given tuple (s, p, q), there are a few good schemes, and scheme_no
% uniquely determines them. 
% ---Inputs---
    % s = number of stages 
    % p = order 
    % q = weak stage order 
% ---Outputs---
    % Butcher tableau: (A,b,c)
%=========================================================================%
    %--------------------------------------------------------------------------
    % SDIRK3M for comparison
    %==========================================================================
    if s==4 && p ==3 && q==1 && scheme_no == 1
        A = [(9/40),0,0,0;(163/520),(9/40),0,0;(-6481433/8838675),(87795409/70709400),(9/40),0;(4032/9943),(6929/15485),(-723/9272),(9/40)];
        b = [(4032/9943),(6929/15485),(-723/9272),(9/40)];
        c = [(9/40),(7/13),(11/15),1]';
    %--------------------------------------------------------------------------
    % 4th order stiffly accurate DIRK for comparison
    %==========================================================================
    elseif s==5 && p ==4 && q==1 && scheme_no == 2 
       A = [.25,0,0,0,0;
            .50,.25,0,0,0;
            .34,-.04,.25,0,0;
            371/1360,-137/2720,15/544,.25,0;
            25/24,-49/48,125/16,-85/12,.25];
        b = [25/24,-49/48,125/16,-85/12,.25];
        c = [0.2500;0.7500;0.5500;0.5000;1.0000];
    %--------------------------------------------------------------------------
    % DIRK-(s,p,q) = DIRK-(5,5,1) for comparison
    %==========================================================================
    elseif s==5 && p==5 && q==1 && scheme_no == 3
        A = [ 4024571134387/14474071345096  0                             0                             0                             0;
              9365021263232/12572342979331  4024571134387/14474071345096  0                             0                             0;
              2144716224527/9320917548702  -397905335951/4008788611757    4024571134387/14474071345096  0                             0;
             -291541413000/6267936762551    226761949132/4473940808273   -1282248297070/9697416712681   4024571134387/14474071345096  0; 
             -2481679516057/4626464057815  -197112422687/6604378783090    3952887910906/9713059315593   4906835613583/8134926921134   4024571134387/14474071345096];
        b = [-2522702558582/12162329469185, 1018267903655/12907234417901, 4542392826351/13702606430957, 5001116467727/12224457745473, 1509636094297/3891594770934];
        c = [4024571134387/14474071345096; 5555633399575/5431021154178; 5255299487392/12852514622453; 3/20; 10449500210709/14474071345096];
    %--------------------------------------------------------------------------
    % DIRK-(s,p,q) = DIRK-(7,4,4). This is the 4th order method with
    % WSO 4 from our WSO paractice paper.
    %==========================================================================
    elseif s == 7 && p == 4 && q == 4 && scheme_no == 4
        A = [ 0.129006634526042                   0                   0                   0                   0                   0                   0
              0.331535445530699   0.117747868000200                   0                   0                   0                   0                   0
             -0.080098196428827  -0.002408450965102   0.092426306480454                   0                   0                   0                   0
             -1.730636616639455   1.513225984674677   1.221258626309848   0.226627903109689                   0                   0                   0
              0.147535379051770   0.361848177223650  -0.560354422024028   2.455453653222619   0.574219016139532                   0                   0
              0.209971781588832   0.712023746367288  -0.020120239407263  -0.019138285395292  -0.005556044541810   0.370727734971297                   0
              0.238793823848388   0.476249540048365   0.012339351512133   0.060119959826938   0.000065536182255  -0.127073091044212   0.339504879626133];
        b = A(end,:);
        c = sum(A,2);
    %--------------------------------------------------------------------------
    % DIRK-(s,p,q) = DIRK-(12,5,4). This is the 5th order method with
    % WSO 4 from our WSO paractice paper.
    %==========================================================================
    elseif s==12 && p ==5 && q==4 && scheme_no == 5
        A = [  0.234537190864627                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
               0.687434441388879   0.055152709806952                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
              -0.118355266953959   0.005463563002913   0.145858445991828                   0                   0                   0                   0                   0                   0                   0                   0                   0
              -0.183223520404229   0.052690294120088   0.820368508513353   0.048121189490921                   0                   0                   0                   0                   0                   0                   0                   0
               0.099415720606594   0.004977904930056   0.054147581742843  -0.001666571741821   0.080789756173325                   0                   0                   0                   0                   0                   0                   0
              -0.989661472158268   2.860682690577833  -1.236119341063179   2.130219523351530  -1.260655031676537   0.245771791309999                   0                   0                   0                   0                   0                   0
              -0.056562384134391   0.166198568576935   0.646460092236251   0.660885496226993   0.373605419887343   0.629445696440769   0.570275260781803                   0                   0                   0                   0                   0
               0.804896210472439  -0.062320349902491   0.573723460332335  -0.096137235114900   0.552410636173793   0.596100248683325   0.197841160065920   0.315623872402401                   0                   0                   0                   0
              -0.160638175921630   0.683339707333771   0.473457866530868   0.803770898487274  -0.010944980694598   0.615126336271130   0.390894684868272   0.089661032653531   0.029732555378570                   0                   0                   0
               0.707428323564463   0.439203730095248  -0.036235924802373   0.000718999030865   0.582096827916655   0.330200317717522  -0.239456402121588  -0.007540283547998   0.170213746952367   0.626878013872171                   0                   0
               0.136119798113369  -0.748654990190283   1.893908350024949   0.394048519673003   0.062402335265450   0.751198386220003  -0.528346526573053  -1.661625677872943   0.999872383319083   1.377776742457387   0.890567640927748                   0
              -0.743367537876828   0.149059442376697  -0.020428840567424   0.000856532943809   1.357261590983184   0.002067512027777   0.098368842657594  -0.013579369745072  -0.054289921749963  -0.038032990382930  -0.009150525836295   0.271235265169451];
        b = A(end,:);
        c = sum(A,2);
    %--------------------------------------------------------------------------
    % DIRK-(s,p,q) = DIRK-(12,5,5). This is the 5th order method with
    % WSO 5 from our WSO paractice paper.
    %==========================================================================
    elseif s==12 && p ==5 && q==5 && scheme_no == 6
        A = [  0.041134735258677                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
               0.160345932772795   0.066639133267228                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
              -0.342438904426475   0.865800632481637   0.098935191169233                   0                   0                   0                   0                   0                   0                   0                   0                   0
               9.437182028870806 -10.887833596423496   2.644025436733866   0.184615580050057                   0                   0                   0                   0                   0                   0                   0                   0
              -0.342540902943082   0.517223927254433   0.916358990967804   0.052251428088457   0.116548543602643                   0                   0                   0                   0                   0                   0                   0
              -2.094441177460360   2.577655753533404   0.570440529332631   0.121363718002352  -0.475228977537660   0.528560596925776                   0                   0                   0                   0                   0                   0
               0.339163178832048  -0.279742702702900   1.039483063369094   0.059787709262122  -0.213290032707038   0.083443183634368   0.241010651577941                   0                   0                   0                   0                   0
               5.904282488642163   3.171195765985073 -12.368228363165867  -0.498951906691300   2.160529620826442   1.916104322021480   1.988059486291180   0.223209238692244                   0                   0                   0                   0
               0.461644350950897  -0.193343356054924  -0.121254148627952   0.066623620397167   0.425491295062526   0.785613164701371   0.836955138935769   0.160478044789593   0.361612595176694                   0                   0                   0
              -0.708766974987820   0.646652709449154   0.475882152654221  -0.257051845137572   1.123185062554392   0.554692161287529   0.319242433323705   0.361207761257697   0.586677983606897   0.235379973624610                   0                   0
               0.426416248485593   1.322816663477840   0.424567372975823  -2.530402764527700  -0.078220168974977   1.054463080605071   0.464559054139189   1.145097379521439   0.430133784689328   1.499513057076809   0.014479426408222                   0
               0.012073943928453   0.518708007464926   0.112130424484724  -0.004959806334781  -1.345031364651444   0.339882870376081   0.815925153167108  -0.002640104266440   0.014390609017635  -0.006556567796750   0.000654813544684   0.545422021065804];
        b = A(end,:);
        c = sum(A,2);
    %=========================Methods with high SL orders=====================%
    %--------------------------------------------------------------------------
    % Method with high semi-linear order: Stage 6, Order 3, and SL order 3.
    %==========================================================================
    elseif s==6 && p ==3 && q==3 && scheme_no == 7
        A = [(13/58),0,0,0,0,0;(39/58),(13/58),0,0,0,0;(-13/58),0,(13/58),0,0,0;(65/174),(-13/348),(-13/116),(13/58),0,0;(2015824758301938982625/11720872553456507801646),(-554819849934875/11076945065425668),(68790302177688571375/269445346056471443716),(7705505568680430000/56998053973484343863),(13/58),0;(3455277656/28312464375),(-1061001132073/3749092092720),(780513524467/5751892408080),(342906676217/1125548760960),(77214825271310213828561/155527924398245799120000),(13/58)];
        b = [(3455277656/28312464375),(-1061001132073/3749092092720),(780513524467/5751892408080),(342906676217/1125548760960),(77214825271310213828561/155527924398245799120000),(13/58)];
        c = [(13/58),(26/29),0,(13/29),(12971/17611),1]';
    %--------------------------------------------------------------------------
    % Method with high semi-linear order: Stage 6, Order 4, and SL order 3. 
    % This is a method from DIRK schemes with high WSO by David et al.
    %==========================================================================
    elseif s==6 && p==4 && q==3 && scheme_no == 8
        A = [0.079672377876931 0 0 0 0 0;
             0.328355391763968 0.136009256546967 0 0 0 0;
            -0.650772774016417 1.742859063495349 0.256472952467792 0 0 0;
            -0.714580550967259 1.793745752775934 -0.078254785672497 0.311753794172585 0 0;
            -1.120092779092918 1.983452339867353 3.117393885836001 -3.761930177913743 0.770646024799205 0;
             0.214823667785537 0.536367363903245 0.154488125726409 -0.217748592703941 0.072226422925896 0.239843012362853];
        b = A(end,:);
        c = sum(A,2);  
    %--------------------------------------------------------------------------% 
    % High semi-linear order method: Stage 7, Order 4, and SL order 4.
    % This method satisfies the extra semilinear order condition without
    % having a stage order of 2.
    %==========================================================================
    elseif s==7 && p==4 && q==4 && scheme_no == 9
        A =  [ 0.000000050675404                   0                   0                   0                   0                   0                   0
               0.714129386047127   0.714129335371719                   0                   0                   0                   0                   0
               0.110476243329833  -0.029602006604617   0.301826571358646                   0                   0                   0                   0
              -5.974636867642467   1.829731241101338   7.564196029481168   0.821730121929775                   0                   0                   0
             -10.161124731847998  -3.676913695391693  14.046214582218884  -0.043611983848188   0.386230239553503                   0                   0
              14.662471220721153  -3.790771578863373 -10.706249908456313   0.038219014098556  -0.203999027826617   0.561450587039992                   0
               0.125099251818450  -0.064493475313523   0.571013965875813   0.000402281931904  -0.008685988240820  -0.000000000000000   0.376663963928177];
        b = A(end,:);
        c = sum(A,2);
    %--------------------------------------------------------------------------
    % SDIRK-(s, p, q) = SDIRK-(10, 5, 4), A-stable, stage order 2, and hence 
    % high WSO and semilinear order 4. 
    %==========================================================================
    elseif s==10 && p ==5 && q==4 && scheme_no == 10
           A = [0,0,0,0,0,0,0,0,0,0;0.27805384113645232E0,0.27805384113645232E0,0,0,0,0,0,0,0,0;(-0.57586836034326278E-1),(-0.57586836034326278E-1),0.27805384113645232E0,0,0,0,0,0,0,0;(-0.79668545047806768E-1),(-0.79668545047806768E-1),0.63101430777343030E-1,0.27805384113645232E0,0,0,0,0,0,0;0.37700174651807026E0,0.37700174651807026E0,(-0.64315398688721876E-1),0,0.27805384113645232E0,0,0,0,0,0;(-0.63214824618711018E-1),(-0.63214824618711018E-1),0.56266152238668400E0,0,0,0.27805384113645232E0,0,0,0,0;(-0.18899425640112775E0),(-0.18899425640112775E0),0.43332315376553469E0,0.23808884815356039E0,0.96736845906384747E-2,(-0.25595459288374821E-1),0.27805384113645232E0,0,0,0;0.12109580167997828E0,0.12109580167997828E0,(-0.13006052713257011E1),0.17766738035960762E1,(-0.85753185795451609E-1),0.39964329066132068E0,(-0.51020408163265306E0),0.27805384113645232E0,0,0;(-0.39742518098670304E0),(-0.39742518098670304E0),(-0.12723982283189617E1),0.17817240872431112E1,(-0.42103845394909238E0),0.31697493460595787E-2,(-0.69230769230769231E0),0.11176470588235294E1,0.27805384113645232E0,0;0.56396134887440429E0,0.56396134887440429E0,(-0.12001800086981505E1),0.16826430124228790E1,(-0.99694597807213397E-1),0.19971220297553713E1,(-0.11578947368421053E1),(-0.11111111111111111E1),(-0.51686112660493095E0),0.27805384113645232E0];
           b = [0.56396134887440429E0,0.56396134887440429E0,(-0.12001800086981505E1),0.16826430124228790E1,(-0.99694597807213397E-1),0.19971220297553713E1,(-0.11578947368421053E1),(-0.11111111111111111E1),(-0.51686112660493095E0),0.27805384113645232E0];
           c = [0,0.55610768227290465E0,0.16288016906779977E0,0.18181818181818182E0,0.96774193548387097E0,0.71428571428571429E0,0.55555555555555556E0,0.80000000000000000E0,0,0.10000000000000000E1]';
    %--------------------------------------------------------------------------
    % DIRK-(s,p,q) = DIRK-(14,5,4), A-stable, high WSO and semilinear order 4
    %==========================================================================
    elseif s==14 && p ==5 && q==4 && scheme_no == 11
            A = [  0.049891598699930                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                   0.270212849592483   0.066023901928356                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                   0.754282338237815   0.012808049378175   0.052569093813501                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                  -0.636758515541051   1.525651024412772   0.245610024490692   0.548023606980618                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0
                  -1.319885676227487   1.337606640593767   0.357529979888603  -0.078506122450546   0.296058938363106                   0                   0                   0                   0                   0                   0                   0                   0                   0
                   3.185292955714723  -3.414866300471474   2.052390992136961   0.619305622279596   0.412293401407645   0.886971825682252                   0                   0                   0                   0                   0                   0                   0                   0
                  -2.060401609534788   5.119433675483093  -1.408083455681850   0.955845328220571  -0.837373020046912   0.024742537330172   0.254223198879450                   0                   0                   0                   0                   0                   0                   0
                   1.185955166157965  -0.988824937776494   2.469922687857976  -0.936355148335294   0.556094857831849   0.875558364344931   0.581504932546450   0.278030547147958                   0                   0                   0                   0                   0                   0
                  -5.349260415447170   0.867928618744797   3.595541613516539   0.404304964180862   1.331956254899576   0.003808253839537   0.106391201448687   0.001599548459418   0.075313877373436                   0                   0                   0                   0                   0
                   4.051657989135328  -1.088596570543614  -3.858727579145360   1.127356313216945   0.298602162118247   2.918413229019855  -3.268461879945366   3.668197015588606   1.305991008763936   0.659609375157041                   0                   0                   0                   0
                  -1.632976330910641   1.368884835689772   1.148818623551998   0.955959397474346   0.183487347069653  -0.496566033186150   1.841605064096353  -0.316332270405794   0.553612137080721   0.021670104335754   0.853338628521461                   0                   0                   0
                  -0.428375325294310  -1.236397439990948   1.206034342967379   0.269243383390169  -2.079974515156806   0.991497997990387   0.332161817154129   3.942420018840060   2.099574414662030   0.428340166050318  -0.000000000000037   0.289516202753243                   0                   0
                  -0.752225103201587   1.081826922734805   1.339385843932917   0.716567187487202   0.812650528308329   2.737035254035022  -0.211141730912880  -1.129245160113743  -0.670354333015629   0.014708076321002  -0.151955141575246  -0.035781145110351   0.730030304427644                   0
                   0.086192326557798   0.588554641066649  -0.008301680458227  -0.044888644562819   0.029391675664832  -0.002060286411414   0.015016528423357   0.000710065926823  -0.000084927160502   0.000074302126569   0.000218094402352  -0.000064198298264   0.000176978909496   0.335065123813349];
            b = A(end,:);
            c = sum(A,2);
    end 
end
%=========================================================================%




